{"version":3,"sources":["./src/app/pages/splash/splash.html","./src/app/pages/splash/splash.module.ts","./src/app/pages/splash/splash.ts"],"names":[],"mappings":"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","file":"pages-splash-splash-module-es2015.js","sourcesContent":["module.exports = \"<ion-content class=\\\"no-scroll\\\" [ngClass]=\\\"{'popup-blur': isShowingAlert}\\\">\\n  <div class=\\\"container\\\"></div>\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\r\nimport { ComponentsModule } from '../../components/components.module'\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { CommonModule } from '@angular/common';\r\nimport { SplashPage } from './splash';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: SplashPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    ComponentsModule,\r\n    RouterModule.forChild(routes)\r\n  ],\r\n  declarations: [SplashPage]\r\n})\r\nexport class SplashPageModule {}\r\n","import { Component } from \"@angular/core\";\r\nimport { Router } from \"@angular/router\";\r\nimport { NavController, ModalController } from \"@ionic/angular\";\r\nimport { DataProvider } from \"../../services/data\";\r\nimport { HttpProvider } from \"../../services/http\";\r\nimport { SmartAudioProvider } from \"../../services/smart-audio\";\r\nimport { UtilsProvider } from \"../../services/utils.service\";\r\nimport { AlertsPage } from \"../alerts/alerts\";\r\n\r\n@Component({\r\n  selector: \"page-splash\",\r\n  templateUrl: \"splash.html\"\r\n})\r\nexport class SplashPage {\r\n  isShowingAlert = false;\r\n  updatingServer: string = \"\";\r\n\r\n  constructor(\r\n    private dataProvider: DataProvider,\r\n    private navCtrl: NavController,\r\n    private smartAudioProvider: SmartAudioProvider,\r\n    private router: Router,\r\n    private httpProvider: HttpProvider,\r\n    private modalCtrl: ModalController,\r\n    private utils: UtilsProvider\r\n  ) {\r\n    this.signIn(this.dataProvider.client, this.dataProvider.APP_VERSION);\r\n\r\n    this.dataProvider.isShowingAlert.subscribe((state) => {\r\n      this.isShowingAlert = state;\r\n    });\r\n    // this.httpProvider.needToShowError.subscribe((payload) => {\r\n    //   if (payload) {\r\n    //     this.presentAlert(payload);\r\n    //   }\r\n    // });\r\n    // this.httpProvider.needToRegister.subscribe((payload) => {\r\n    //   if (payload) {\r\n    //     this.gotoRegister(payload);\r\n    //   }\r\n    // });\r\n  }\r\n\r\n  async signIn(client: string, version: string) {\r\n    console.log(\r\n      \"platform: \" + this.dataProvider.platform + \", client: \" + client\r\n    );\r\n\r\n    let token = await this.dataProvider.getFromStorage(\"token\");\r\n\r\n    this.hello(client, token, version);\r\n  }\r\n\r\n  hello(client: string, token: string, version: string) {\r\n    if (this.dataProvider.developerMode) {\r\n      // (main-server: shahoosh)\r\n      // token = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MzU1NDc2LCJ0aW1lIjoiMjAyMC0wMi0wMlQxMToyODo0Mi4xOTdaIiwiaWF0IjoxNTgwNjQyOTIyfQ.kW1E0NZBA9pJoQAK4hJAa1DQ8IN7dDGqJkJ2aCqO2VM\"\r\n      // (main-server: Hesam)\r\n      // token =\r\n      //   \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MTYsInRpbWUiOiIyMDIwLTEwLTA1VDEyOjU3OjQ5LjQ5M1oiLCJpYXQiOjE2MDE5MDI2Njl9.e7N7qaiNxVUD8SXoBJClPziWUqFJlOI6jseKB1lnJMY\";\r\n      // (local-server:Hesam)\r\n      // token =\r\n      //   \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MTYsInRpbWUiOiIyMDIwLTEwLTA1VDE0OjEzOjI1LjkxMFoiLCJpYXQiOjE2MDE5MDcyMDV9.xl6-gF8sjAd8xe1qRF4QWlDSegCdUjKhPOw-Gt9x0c8\";\r\n    }\r\n\r\n    const body = {\r\n      client,\r\n      version,\r\n      token,\r\n      timezone: new Date().getTimezoneOffset()\r\n    };\r\n\r\n    this.httpProvider.post(\"/users/auth/hello\", body, (res: any) => {\r\n      if (res.status == \"success\") {\r\n        this.smartAudioProvider.play(\"achive\");\r\n\r\n        if (res.data.popup) {\r\n          setTimeout(() => this.presentAlert(res.data.popup), 4400);\r\n        }\r\n\r\n        this.utils.setDataAndGoToGame(res.data);\r\n      } else {\r\n        this.presentAlert(res.data);\r\n      }\r\n    });\r\n  }\r\n\r\n  gotoRegister(payload: any) {\r\n    setTimeout(() => {\r\n      this.navCtrl.setDirection(\"root\");\r\n      // this.router.navigate([\"factions\"], { state: { payload } });\r\n    }, 3000);\r\n  }\r\n\r\n  async presentAlert(payload: any) {\r\n    if (!this.isShowingAlert) {\r\n      let prizeModal = await this.modalCtrl.create({\r\n        component: AlertsPage,\r\n        componentProps: { payload }\r\n      });\r\n      prizeModal.present();\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":""}